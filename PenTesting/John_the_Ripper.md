# John the Ripper (Jumbo John)
Tool for dictionary attacks on various hash types/passwords.  
___
## Wordlist 
A good collection can be found here [SecLists](https://github.com/danielmiessler/SecLists)  
`rockyou.txt`
___
## Basic Syntax
`john [options] [file path]`

John has also a built-in features that detect what type of has it is:  
```bash
john --wordlist=[path to wordlist] [path to file]
```  
___
## Identifying the hashes
You can use tools like [hash-identifier](https://gitlab.com/kalilinux/packages/hash-identifier/-/tree/kali/master) or [online hash identifiers](https://hashes.com/en/tools/hash_identifier) to determine a hash type when John doesn't automatically recognize it.  
Download [hash-id.py](https://gitlab.com/kalilinux/packages/hash-identifier/-/raw/kali/master/hash-id.py) using `wget` or `curl`, then run it with python3 to get a list of probable hash formats.  

Once you've identified the hash type, use John with the --format flag to specify it while cracking. The syntax is:  
`john --format=[format] --wordlist=[path to wordlist] [path to file]`  
For standard hashes like MD5, prefix with `raw-` (e.g., `raw-md5`). To check available formats, use:  
`john --list=formats | grep -iF "md5"`  
___
## NTHash/NTLM 
NTHash (NTLM) is the hash format used by modern Windows systems to store passwords. It evolved from the older LM hash format. Windows stores these hashes in the SAM database or NTDS.dit (for Active Directory). Tools like Mimikatz can be used to extract them.  
___
## Cracking Hashes from /etc/shadow
The `/etc/shadow` file on Linux stores password hashes and other user authentication details. To crack these hashes, you need root access.  
The `unshadow` tool (part of John the Ripper) merges `/etc/passwd` and `/etc/shadow` files into a format John can process.  
The command `unshadow [path to passwd] [path to shadow] > unshadowed.txt` creates the required file.  

- `unshadow`: Invokes the unshadow tool.  
- `[path to passwd]`: The file that contains the copy of the /etc/passwd file you’ve taken from the target machine.  
- `[path to shadow]`: The file that contains the copy of the /etc/shadow file you’ve taken from the target machine.  

You can then use John to crack passwords with a wordlist, e.g.:  

```bash
john --wordlist=/usr/share/wordlists/rockyou.txt --format=sha512crypt unshadowed.txt  
```
___
## Single Crack Mode
John the Ripper’s **Single Crack Mode** generates passwords based on the username by applying **word mangling** techniques (e.g., adding numbers, symbols, or changing capitalization). It also utilizes the **GECOS field** from `/etc/passwd` to expand its wordlist with user-related information.  
GECOS stands for General Electric Comprehensive Operating System. In `/etc/shadow` and `/etc/passwd`  fields are separated by `:`, the fifth field in the user account record is GECOS field.  
It stores general information about the user, such as the user’s full name, office number, and telephone number, among other things. John can take information stored in those records, such as full name and home directory name, to add to the wordlist it generates when cracking /etc/shadow hashes with single crack mode.  

To use Single Crack Mode:  
```bash
john --single --format=[format] [path to file]
```  
Example:  
```bash
john --single --format=raw-sha256 hashes.txt
```  
**Note:** In this mode, hashes must be formatted as `username:hash` for John to process them correctly.  
___
## Custom Rules
**Custom Rules** in John the Ripper allow you to define password modification patterns to generate dynamic wordlists. This is useful when you know common password structures, such as capitalizing the first letter, appending a number, and adding a symbol (e.g., `Polopassword1!`).  

**Creating Custom Rules:**  
[wiki](https://www.openwall.com/john/doc/RULES.shtml)
Custom rules are defined in **john.conf** (e.g., `/etc/john/john.conf`). The syntax includes:  
- **`[List.Rules:PoloPassword]`** ->  define the name of your rule; this is what you will use to call your custom rule a John argument.  
then use a regex style pattern match to define where the word will be modified. Some of the most common modifiers:  
- **`c`** -> Capitalizes a character  
- **`Az`** -> Appends specified characters  
- **`A0`** -> Prepends specified characters  
- **Character sets**: `[0-9]`, `[A-Z]`, `[!£$%@]`, etc.  

Example rule for `Polopassword1!`:  
```plaintext
[List.Rules:PoloPassword]
cAz"[0-9] [!£$%@]"
```
This capitalizes the first letter, appends a number (0-9), and a symbol.  

**Using Custom Rules:**  
To apply the rule in John:  
```bash
john --wordlist=[path to wordlist] --rule=PoloPassword [path to file]
```  
Jumbo John includes many prebuilt rules (check around **line 678** in john.conf for references).
___
## Zip files
**Summary:**  
John the Ripper can crack password-protected **ZIP files** using the `zip2john` tool to convert the ZIP file into a hash format that John can process.  

**Steps to Crack a ZIP Password:**  
1. **Extract the hash from the ZIP file:**  
   ```bash
   zip2john zipfile.zip > zip_hash.txt
   ```  
2. **Use John to crack the hash:**  
   ```bash
   john --wordlist=/usr/share/wordlists/rockyou.txt zip_hash.txt
   unzip zipfile.zip
   ```  
This method is similar to using `unshadow` for `/etc/shadow` password hashes.
___
## RAR Archive
John the Ripper can crack **password-protected RAR archives** using the `rar2john` tool, which extracts the hash from the RAR file for John to process.  

**Steps to Crack a RAR Password:**  
1. **Extract the hash from the RAR file:**  
   ```bash
   rar2john rarfile.rar > rar_hash.txt
   ```  
2. **Use John to crack the hash:**  
   ```bash
   john --wordlist=/usr/share/wordlists/rockyou.txt rar_hash.txt
   unrar x file.rar
   ```  
This process is similar to cracking ZIP file passwords with `zip2john`.  
___
## SSH
John the Ripper can crack **password-protected SSH private keys** (`id_rsa`) using the `ssh2john` tool, which extracts the hash for John to process.  
**Steps to Crack an SSH Private Key Password:**  
1. **Convert the SSH private key into a hash format:**  
   ```bash
   ssh2john id_rsa > id_rsa_hash.txt
   OR
   /opt/john/ssh2john.py id_rsa > id_rsa_hash.txt
   ```  
   *(Use `python3 /opt/john/ssh2john.py` if `ssh2john` isn’t installed.)*  

2. **Use John to crack the hash:**  
   ```bash
   john --wordlist=/usr/share/wordlists/rockyou.txt id_rsa_hash.txt
   ```  
This method allows access to an encrypted SSH private key, enabling authentication without knowing the original password.
___
## Dodatkowe informacje
[openwall](https://www.openwall.com/john/)
___
## Sources
- tryhackme, John the Ripper: The Basics, https://tryhackme.com/r/room/johntheripperbasics.